temporal:
  enabled: true
  image:
    repository: "temporalio/auto-setup"
    tag: "1.24.2"
  replicaCount: 1
  resources:
    requests:
      memory: 1Gi
      cpu: 500m
    limits:
      memory: 2Gi
      cpu: 1000m
  env:
    DB: "postgres12"
    DB_PORT: "5432"
    POSTGRES_USER: "temporal"
    POSTGRES_PWD: "temporal-dev-password"
    POSTGRES_SEEDS: "postgres.stackai-data.svc.cluster.local"
    SKIP_SCHEMA_SETUP: "false"
    ENABLE_ES: "false"
    secrets:
      useExternalSecrets: false
  securityContext:
    enabled: false
  podSecurityContext:
    enabled: false
  # Disable probes for Temporal server (gRPC service doesn't expose HTTP health endpoints)
  livenessProbe:
    enabled: false
  readinessProbe:
    enabled: false

temporalWeb:
  enabled: true
  image:
    repository: "temporalio/ui"
    tag: "2.29.0"
  replicaCount: 1
  resources:
    requests:
      memory: 512Mi
      cpu: 200m
    limits:
      memory: 1Gi
      cpu: 500m
  env:
    TEMPORAL_ADDRESS: "temporal-stackai-temporal-server:7233"
    TEMPORAL_CORS_ORIGINS: "http://temporal.localhost,https://temporal.localhost"
  # Fix service port to match what the container actually uses
  service:
    type: ClusterIP
    ports:
      http: 8080
  securityContext:
    enabled: false
  podSecurityContext:
    enabled: false
  # Fix liveness and readiness probes with increased timeouts
  livenessProbe:
    enabled: true
    httpGet:
      path: /
      port: http
      scheme: HTTP
    initialDelaySeconds: 60
    periodSeconds: 30
    timeoutSeconds: 15
    failureThreshold: 5
    successThreshold: 1
  readinessProbe:
    enabled: true
    httpGet:
      path: /
      port: http
      scheme: HTTP
    initialDelaySeconds: 45
    periodSeconds: 10
    timeoutSeconds: 10
    failureThreshold: 5
    successThreshold: 1

ingress:
  enabled: true
  className: "nginx"
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
    nginx.ingress.kubernetes.io/use-regex: "true"
    nginx.ingress.kubernetes.io/rewrite-target: /$2
  hosts:
    - host: localhost
      paths:
        - path: /temporal(/|$)(.*)
          pathType: ImplementationSpecific
  tls: []

externalSecrets:
  enabled: false
